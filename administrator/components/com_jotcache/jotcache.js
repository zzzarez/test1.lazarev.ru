var jotcache={lang:[],re:/^[._a-zA-Z0-9-]+[=]?[._a-zA-Z0-9-]+/,init:function(a){this.lang=a;this.cbset=true;$$("input[name^=ex]").each(function(b,c){this.validate(b,c);b.addEvent("click",this.clicked.bind(b,c));b.addEvent("change",this.changed.bind(b,c));this.cbox=$("cb"+c);this.cbox.addEvent("click",this.switched.bind(this.cbox,b))},this)},switched:function(a){if(!this.getProperty("checked")){a.setProperty("value","")}},pressed:function(){this.cbset=false;this.checked=true;$$("input[name^=ex]").each(function(a,b){if(a.getValue()!=""){if(jotcache.validate(a,b)){a.setStyle("border","red solid 2px");this.checked=false}}},this);return this.checked},changed:function(a){jotcache.clicked.attempt(a,this);this.setProperty("value",jotcache.cleared)},clicked:function(b){this.cbset=true;this.joterr=jotcache.validate(this,b);if(!this.joterr&&this.getNext()){this.getNext().remove()}if(this.joterr){var a=new Element("div");a.appendText(jotcache.str+" ("+jotcache.lang[0]+" )");if(!this.getNext()){a.injectAfter(this)}else{this.getNext().remove();a.injectAfter(this)}}},validate:function(a,b){this.val=$(a).getValue();if(this.val==""){this.cleared="";a.setStyle("border","silver solid 1px");return false}this.joterr=false;this.cleared=this.val.replace(/\s*/g,"").replace(/[:]*/g,"");this.str="";this.cleared.split(",").each(function(c){this.mtch=c.match(this.re);if(this.mtch==null){this.mtch=""}if(!this.joterr){if(this.str!=""){this.str=this.str+","}this.str=this.str+this.mtch}if(c!=this.mtch){this.joterr=true}},this);if(this.cleared!=this.str){a.setStyle("border","red solid 2px");return true}else{a.setStyle("border","silver solid 1px");if(this.cbset){$("cb"+b).checked="checked"}return false}}};